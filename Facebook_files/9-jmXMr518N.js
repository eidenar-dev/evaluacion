if (self.CavalryLogger) { CavalryLogger.start_js(["v9mnm"]); }

__d("InstantGameUpdateXMATUpdateType",[],(function a(b,c,d,e,f,g){f.exports={UNKNOWN:"unknown",GAME_SCORE:"game_score",CUSTOM_MESSAGE:"custom_message"};}),null);
__d("MNCommerceBubbleType",[],(function a(b,c,d,e,f,g){f.exports={FB_RETAIL_RECEIPT:1,FB_RETAIL_CANCELLATION:2,FB_RETAIL_SHIPMENT:3,FB_RETAIL_SHIPMENT_TRACKING_EVENT_ETA:4,FB_RETAIL_SHIPMENT_TRACKING_EVENT_IN_TRANSIT:5,FB_RETAIL_SHIPMENT_TRACKING_EVENT_OUT_FOR_DELIVERY:6,FB_RETAIL_SHIPMENT_TRACKING_EVENT_DELAYED:7,FB_RETAIL_SHIPMENT_TRACKING_EVENT_DELIVERED:8,FB_RETAIL_SHIPMENT_FOR_UNSUPPORTED_CARRIER:9,FB_RETAIL_SHIPMENT_ETA:10,FB_RETAIL_NOW_IN_STOCK:11,FB_RETAIL_AGENT_ITEM_SUGGESTION:12,FB_RETAIL_AGENT_ITEM_RECEIPT:13,FB_RETAIL_PROMOTIONAL_MSG:14};}),null);
__d('bs_js_undefined',[],(function a(b,c,d,e,f,g){'use strict';function h(k,l){if(k!==undefined){return l(k);}else return undefined;}function i(k,l){if(k!==undefined){return l(k);}else return 0;}function j(k){if(k){return k[0];}else return undefined;}g.bind=h;g.iter=i;g.from_opt=j;}),null);
__d('MessagingTagUtils',['MessagingSourceEnum','MessagingTagConstants','MercuryMessageSourceTags','Set'],(function a(b,c,d,e,f,g){'use strict';var h=new (c('Set'))(Object.values(c('MessagingSourceEnum')));function i(l){for(var m=l,n=Array.isArray(m),o=0,m=n?m:m[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var p;if(n){if(o>=m.length)break;p=m[o++];}else{o=m.next();if(o.done)break;p=o.value;}var q=p;if(h.has(q))return q;}return c('MessagingSourceEnum').UNKNOWN;}function j(l){for(var m=l,n=Array.isArray(m),o=0,m=n?m:m[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var p;if(n){if(o>=m.length)break;p=m[o++];}else{o=m.next();if(o.done)break;p=o.value;}var q=p,r=q.split(c('MessagingTagConstants').app_id_root);if(r.length>1)return r[1].trim();}return null;}function k(l,m){var n=[],o=j(l);if(o&&c('MessagingTagConstants').orca_app_ids.indexOf(o)!==-1)n.push(c('MercuryMessageSourceTags').MESSENGER);if(c('MessagingTagConstants').chat_sources.indexOf(m)!==-1)n.push(c('MercuryMessageSourceTags').CHAT);if(c('MessagingTagConstants').email_source===m)n.push(c('MercuryMessageSourceTags').EMAIL);if(c('MessagingTagConstants').mobile_sources.indexOf(m)!==-1)n.push(c('MercuryMessageSourceTags').MOBILE);return n;}f.exports={getSourceFromTags:i,getSourceTags:k};}),null);
__d('messengerStoryAttachmentTransformerRe',['fbt','bs_array','bs_string','bs_caml_array','bs_js_boolean','bs_caml_format','CurrentUser','bs_js_primitive','bs_js_undefined','FundsAvailability','bs_js_null_undefined','P2PTransferStatus','MNCommerceBubbleType','PaymentModulesClient','MercuryAttachmentType','bs_caml_builtin_exceptions','P2PPaymentRequestStatus','ServicesCalendarSyncType','MNCommerceCallToActionType','MNCommerceShipmentTrackingEventTypes'],(function a(b,c,d,e,f,g,h){'use strict';function i(ra){return c('bs_array').map(function(sa){var ta=sa.user_confirmation,ua=c('bs_js_primitive').is_nil_undef(ta)?[null,null,null,null,false]:[ta.cancel_button_label,ta.continue_button_label,ta.confirmation_message,ta.confirmation_title,true],va=sa.payment_metadata;return {action_link:sa.action_link,action_type:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('MNCommerceCallToActionType')[sa.action_open_type])),title:sa.title,confirmation_cancel_label:ua[0],confirmation_continue_label:ua[1],confirmation_message:ua[2],confirmation_title:ua[3],id:sa.id,is_disabled:sa.is_disabled,is_mutable_by_server:sa.is_mutable_by_server,payment_metadata:c('bs_js_primitive').is_nil_undef(va)?{payment_module_config:null,total_price:null}:{payment_module_config:va.payment_module_config,total_price:va.total_price},render_style:sa.render_style,webview_metadata:{messenger_extensions:sa.webview_metadata.messenger_extensions,webview_height_ratio:sa.webview_metadata.webview_height_ratio,webview_share_button:sa.webview_metadata.webview_share_button},should_show_user_confirmation:ua[4]};},ra);}function j(ra){return c('bs_array').map(function(sa){return {title:sa.title,url:sa.url};},ra);}function k(ra){if(!c('bs_js_primitive').is_nil_undef(ra)&&ra!==""){return "#"+c('bs_string').sub(ra,2,ra.length-2|0);}else return null;}function l(ra){if(c('bs_js_primitive').is_nil_undef(ra)){return null;}else return {url:ra.uri,src:ra.uri,width:ra.width,height:ra.height};}function m(ra){return {id:ra.id,name:ra.name,desc:ra.desc,thumb_url:ra.thumb_url,item_url:ra.item_url,title:ra.name,text:ra.desc,source:ra.source,image_aspect_ratio:ra.image_aspect_ratio,metalines:{metaline_1:ra.first_metaline,metaline_2:ra.second_metaline,metaline_3:ra.third_metaline},call_to_actions:i(ra.call_to_actions)};}function n(ra){return {city:ra.city,country:ra.country,latitude:ra.latitude,longitude:ra.longitude,postal_code:ra.postal_code,state:ra.state,street_1:ra.streets.length?c('bs_caml_array').caml_array_get(ra.streets,0):null,street_2:ra.streets.length>1?c('bs_caml_array').caml_array_get(ra.streets,1):null,timezone:ra.timezone};}function o(ra){var sa=ra.retail_carrier,ta=ra.shipdate_for_display,ua={};c('bs_array').iter(function(ab){var bb=ab.messenger_commerce_location;if(c('bs_js_primitive').is_nil_undef(bb)){return 0;}else{ua[ab.id]=n(bb);return 0;}},ra.shipment_tracking_events.nodes);var va={};c('bs_array').iter(function(ab){var bb=m(ab);va[bb.id]=bb;return 0;},ra.retail_shipment_items.nodes);var wa=sa.logo,xa=sa.legal_terms_of_service_text,ya=ra.receipt,za=ra.recipient;return {id:ra.id,shipment_id:ra.id,tracking_number:ra.tracking_number,carrier:sa.name,carrier_tracking_url:sa.carrier_tracking_url,carrier_logo:c('bs_js_primitive').is_nil_undef(wa)?null:{url:wa.uri,width:wa.width,height:wa.height},display_ship_date:ta,estimated_delivery_display_time:ra.estimated_delivery_time_for_display,origin:n(ra.commerce_origin),destination:n(ra.commerce_destination),items:va,tracking_event_polyline:ua,legal_text:c('bs_js_primitive').is_nil_undef(xa)?null:xa.text,receipt_id:c('bs_js_primitive').is_nil_undef(ya)?null:ya.receipt_id,recipient_name:c('bs_js_primitive').is_nil_undef(za)?null:za.name,delivered:c('bs_array').fold_left(function(ab,bb){if(bb.shipment_tracking_event_type==="DELIVERED"){return true;}else return ab;},false,ra.shipment_tracking_events.nodes),messenger_commerce_bubble_type:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('MNCommerceBubbleType')[ra.bubble_type]))};}function p(ra){var sa=ra.shipment.estimated_delivery_time_for_display,ta=ra.shipment.shipdate_for_display,ua=ra.shipment.retail_carrier,va={};c('bs_array').iter(function(ya){var za=ya.messenger_commerce_location;if(c('bs_js_primitive').is_nil_undef(za)){return 0;}else{va[ya.id]=n(za);return 0;}},ra.shipment.shipment_tracking_events.nodes);var wa=ra.messenger_commerce_location,xa=ua.logo;return {id:ra.id,shipment_id:ra.shipment.id,tracking_number:ra.shipment.tracking_number,display_ship_date:ta,estimated_delivery_display_time:sa===""?ta:sa,origin:n(ra.shipment.commerce_origin),destination:n(ra.shipment.commerce_destination),carrier:ua.name,carrier_tracking_url:ua.carrier_tracking_url,display_time:ra.tracking_event_time_for_display,tracking_event_type:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('MNCommerceShipmentTrackingEventTypes')[ra.shipment_tracking_event_type])),tracking_event_location:c('bs_js_primitive').is_nil_undef(wa)?null:n(wa),tracking_event_description:ra.tracking_event_description,tracking_event_polyline:va,carrier_logo:c('bs_js_primitive').is_nil_undef(xa)?null:{url:xa.uri,width:xa.width,height:xa.height},items:c('bs_array').map(m,ra.shipment.retail_shipment_items.nodes),messenger_commerce_bubble_type:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('MNCommerceBubbleType')[ra.bubble_type])),delivered:c('bs_js_boolean').to_js_boolean(+(ra.shipment_tracking_event_type==="DELIVERED"))};}function q(ra){var sa=ra.itinerary_legs.nodes,ta=[],ua=[];c('bs_array').iter(function(va){var wa=va.segments.nodes;c('bs_array').iter(function(xa){var ya=xa.flight_info;ta.push({departure_datetime_for_display:ya.departure_time_info.formatted_datetime_for_display,destination_airport_code:ya.arrival_airport.airport_code,destination_airport_name:ya.arrival_airport.city,labels:va.number_of_stops_label,source_airport_code:ya.departure_airport.airport_code,source_airport_name:ya.departure_airport.city});return 0;},wa);c('bs_array').iter(function(xa){var ya=xa.flight_info,za=ya.arrival_time_info;ua.push({flight_info:{aircraft_type:ya.aircraft_type,arrival_airport:{airport_code:ya.arrival_airport.airport_code,city:ya.arrival_airport.city,terminal:ya.arrival_airport.terminal},arrival_time:c('bs_js_primitive').is_nil_undef(za)?null:za.formatted_time_for_display,departure_airport:{airport_code:ya.departure_airport.airport_code,city:ya.departure_airport.city,terminal:ya.departure_airport.terminal},departure_date:ya.departure_time_info.formatted_date_for_display,departure_time:ya.departure_time_info.formatted_time_for_display,flight_number:ya.flight_number},passenger:c('bs_array').map(function(ab){return {name:ab.passenger.name,passenger:{name:ab.passenger.name,ticket_number:ab.passenger.ticket_number},product_infos:c('bs_array').map(function(bb){return {title:bb.title,value:bb.value};},ab.product_items),seat:ab.seat,seat_type:ab.seat_type,travel_class:ab.travel_class};},xa.passenger_details)});return 0;},wa);return 0;},sa);return {base_cost:ra.formatted_base_price,confirmation_number:ra.confirmation_number,logo:l(ra.logo),passenger_names:c('bs_array').map(function(va){return va.name;},ra.passenger_infos),pnr_number:ra.pnr_number,price_info:c('bs_array').map(function(va){return {title:va.title,value:va.formatted_amount};},ra.itemized_price_infos),tax:ra.formatted_tax,theme_color:k(ra.tint_color),total_cost:ra.formatted_total,connections:ta,labels:{aircraft_type_label:ra.aircraft_type_label,arrival_time_label:ra.arrival_time_label,base_price_label:ra.base_price_label,booking_number_label:ra.booking_number_label,cabin_type_label:ra.cabin_type_label,departure_time_label:ra.departure_time_label,flight_confirmation_label:ra.flight_confirmation_label,flight_date_label:ra.flight_date_label,flight_label:ra.flight_label,flight_terminal_label:ra.flight_terminal_label,itinerary_error_title_label:ra.itinerary_error_title_label,itinerary_title_label:ra.itinerary_title_label,passenger_name_label:ra.passenger_name_label,passenger_names_label:ra.passenger_names_label,passenger_seat_label:ra.passenger_seat_label,purchase_summary_label:ra.purchase_summary_label,taxes_label:ra.taxes_label,total_label:ra.total_label,view_details_cta_label:ra.view_details_cta_label},flight_segments:ua};}function r(ra){var sa=ra.flight_info,ta=sa.arrival_time_info;return {pnr_number:ra.pnr_number,theme_color:k(ra.tint_color),update_type:ra.update_type,hightlighted_labels:ra.hightlighted_labels,labels:{arrival_time_label:ra.arrival_time_label,booking_number_label:ra.booking_number_label,departure_time_label:ra.departure_time_label,flight_gate_label:ra.flight_gate_label,flight_label:ra.flight_label,flight_status_label:ra.flight_status_label,passenger_names_label:ra.passenger_names_label,passenger_seat_label:ra.passenger_seat_label},logo:l(ra.logo),update_flight_info:{arrival_airport:{airport_code:sa.arrival_airport.airport_code,city:sa.arrival_airport.city},arrival_time:c('bs_js_primitive').is_nil_undef(ta)?null:ta.formatted_time_for_display,departure_airport:{airport_code:sa.departure_airport.airport_code,city:sa.departure_airport.city},departure_gate:sa.departure_airport.gate,flight_number:sa.flight_number,departure_time:sa.departure_time_info.formatted_time_for_display}};}function s(ra){var sa=c('bs_array').map(function(ta){var ua=ta.arrival_time_info;return {arrival_airport:{airport_code:ta.arrival_airport.airport_code,city:ta.arrival_airport.city},departure_airport:{airport_code:ta.departure_airport.airport_code,city:ta.departure_airport.city},flight_number:ta.flight_number,departure_time:ta.departure_time_info.formatted_time_for_display,arrival_time:c('bs_js_primitive').is_nil_undef(ua)?null:ua.formatted_time_for_display};},ra.flight_infos);return {pnr_number:ra.pnr_number,theme_color:k(ra.tint_color),checkin_url:ra.checkin_url,flight_info:sa,labels:{flight_label:ra.flight_label,arrival_time_label:ra.arrival_time_label,departure_time_label:ra.departure_time_label,checkin_cta_label:ra.checkin_cta_label,booking_number_label:ra.booking_number_label},logo:l(ra.logo)};}function t(ra){var sa=ra.boarding_passes.nodes,ta;if(sa.length){var ua=c('bs_caml_array').caml_array_get(sa,0),va=ua.flight_info,wa=va.boarding_time_info;ta={flight_number:va.flight_number,boarding_time_for_display:c('bs_js_primitive').is_nil_undef(wa)?null:wa.formatted_time_for_display,departure_time_for_display:va.departure_time_info.formatted_time_for_display,departure_terminal:va.departure_airport.terminal,departure_gate:va.departure_airport.gate,destination_airport_code:va.arrival_airport.airport_code,destination_airport_name:va.arrival_airport.city,source_airport_code:va.departure_airport.airport_code,source_airport_name:va.departure_airport.city};}else ta=null;return {flight_information:ta,theme_color:k(ra.tint_color),passenger_seat_assignment:c('bs_array').map(function(xa){return {name:xa.passenger.passenger.name,seat:xa.passenger.seat};},sa),labels:{flight_label:ra.flight_label,boarding_time_label:ra.boarding_time_label,departure_label:ra.departure_label,passenger_names_label:ra.passenger_names_label,passenger_seat_label:ra.passenger_seat_label,flight_terminal_label:ra.flight_terminal_label,flight_gate_label:ra.flight_gate_label,view_boarding_pass_cta_label:ra.view_boarding_pass_cta_label,share_cta_label:ra.share_cta_label,message_cta_label:ra.message_cta_label,boarding_pass_title_label:ra.boarding_pass_title_label,boarding_pass_error_title_label:ra.boarding_pass_error_title_label},logo:l(ra.logo),boarding_pass:c('bs_array').map(function(xa){var ya=xa.header_text_field;return {source_page_id:0,logo_image_url:xa.airline_logo_image_url,header_image_url:xa.header_image_url,auxiliary_fields:c('bs_array').map(function(za){return {label:za.title,value:za.value};},xa.auxiliary_fields),secondary_fields:c('bs_array').map(function(za){return {label:za.title,value:za.value};},xa.secondary_fields),qr_code_header_image_url:xa.qr_code_header_image_url,qr_code_url:xa.qr_code_image_url,passenger_name:xa.passenger.passenger.name,header_text_field:c('bs_js_primitive').is_nil_undef(ya)?null:{label:ya.title,value:ya.value}};},sa)};}function u(ra,sa){var ta=sa.cover_photo,ua;if(c('bs_js_primitive').is_nil_undef(ta)){ua=[null,null,null];}else{var va=ta.photo.image,wa=c('bs_js_primitive').is_nil_undef(va)?[null,null]:[va.uri,{height:va.height,width:va.width}];ua=[ta.photo.id,wa[0],wa[1]];}var xa=sa.location,ya=c('bs_js_primitive').is_nil_undef(xa)?[null,null]:[xa.latitude,xa.longitude],za=sa.overall_star_rating;return {address:sa.address.single_line_full_address,category:sa.top_category_name,coverPhotoID:ua[0],coverPhotoURL:ua[1],coverPhotoDimensions:ua[2],latitude:ya[0],longitude:ya[1],name:sa.name,rating:c('bs_js_primitive').is_nil_undef(za)?null:za.value,pageID:sa.id,priceRange:sa.price_range_description,viewerID:ra};}function v(ra){var sa=ra.group_commerce_item_seller,ta=ra.primary_photo,ua;if(c('bs_js_primitive').is_nil_undef(ta)){ua=null;}else{var va=ta.image;ua=c('bs_js_primitive').is_nil_undef(va)?null:va.uri;}return {caption:ra.group_commerce_item_description.text,desc:ra.group_commerce_item_description.text,owner_id:c('bs_js_primitive').is_nil_undef(sa)?null:sa.id,price:ra.formatted_price.text,text:ra.group_commerce_item_description.text,title:ra.group_commerce_item_title,thumb_url:ua,url:ra.url};}function w(ra){return {app_name:ra.application_name,artists:ra.artist_names,audio_url:ra.audio_url,duration_ms:ra.duration_ms,title:ra.music_title};}function x(ra){var sa=ra.payment;return {id:ra.id,desc:ra.desc,display_total_cost:ra.total_cost,merchant_name:ra.merchant_name,target_url:ra.target_url,thumb_url:ra.thumb_url,raw_amount:ra.raw_amount,payment_id:c('bs_js_primitive').is_nil_undef(sa)?null:sa.id,total_cost:{amount:c('bs_caml_format').caml_float_of_string(ra.price_amount),currency:ra.price_currency},name:ra.name};}function y(ra){return {id:ra.id,canDonate:ra.canDonate,hadViewerDonated:ra.hadViewerDonated,fundraiserDetailedProgressText:ra.fundraiserDetailedProgressText,fundraiserSubtitleText:ra.fundraiserSubtitleText,focusedCoverPhoto:ra.focusedCoverPhoto};}function z(ra){return {id:ra.id,name:ra.name,desc:ra.desc,thumb_url:ra.thumb_url,item_url:ra.item_url,title:ra.name,text:ra.desc,source:ra.source,image_aspect_ratio:ra.image_aspect_ratio,metalines:{metaline_1:ra.first_metaline,metaline_2:ra.second_metaline,metaline_3:ra.third_metaline},call_to_actions:i(ra.call_to_actions)};}function aa(ra){var sa=ra.guestStatus,ta=ra.event_place,ua=ra.social_context;return {eventID:ra.eventID,guestStatus:c('bs_js_primitive').is_nil_undef(sa)?"unknown":c('bs_string').lowercase(sa),canViewerJoin:ra.canViewerJoin,timeString:ra.timeString,locationString:c('bs_js_primitive').is_nil_undef(ta)?null:ta.name,socialOrTimeContextString:c('bs_js_primitive').is_nil_undef(ua)?null:ua.text,connectedButtonText:h._("Participar\u00e1s"),unconnectedButtonText:h._("Asistir\u00e9"),watchStatus:c('bs_string').lowercase(ra.watchStatus),showInterestedAction:c('bs_js_boolean').to_js_boolean(+(ra.connection_style==="INTERESTED")),canViewerWatch:ra.canViewerWatch};}function ba(ra){var sa=function qb(rb){var sb=rb.page_call_to_action;if(c('bs_js_primitive').is_nil_undef(sb)){return undefined;}else return sb.id;},ta=function qb(rb){var sb=rb.page_call_to_action;if(c('bs_js_primitive').is_nil_undef(sb)){return false;}else{var tb=sb.component_flow_service_config;if(c('bs_js_primitive').is_nil_undef(tb)){return false;}else return true;}},ua=ra.page,va=c('bs_js_primitive').is_nil_undef(ua)?[undefined,undefined,undefined,false]:[ua.id,c('bs_js_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('ServicesCalendarSyncType')[ua.calendar_sync_type])),sa(ua),ta(ua)],wa=ra.native_component_flow_request,xa;if(c('bs_js_primitive').is_nil_undef(wa)){xa=null;}else{var ya=wa.page,za=wa.page,ab=wa.page,bb;if(c('bs_js_primitive').is_nil_undef(ab)){bb=undefined;}else{var cb=ab.profile_picture;bb=c('bs_js_primitive').is_nil_undef(cb)?undefined:cb.uri;}var db=wa.suggested_time_range,eb=wa.product_item,fb=wa.product_item,gb=wa.product_item,hb;if(c('bs_js_primitive').is_nil_undef(gb)){hb=undefined;}else{var ib=gb.profile_picture;hb=c('bs_js_primitive').is_nil_undef(ib)?undefined:ib.uri;}var jb=wa.user,kb=wa.user,lb=wa.user,mb;if(c('bs_js_primitive').is_nil_undef(lb)){mb=undefined;}else{var nb=lb.profile_picture;mb=c('bs_js_primitive').is_nil_undef(nb)?undefined:nb.uri;}xa={availability:wa.availability,calendarSyncType:c('bs_js_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('ServicesCalendarSyncType')[wa.calendar_sync_type])),hasSavedToCalendar:wa.has_saved_to_calendar,generalInfo:wa.service_general_info,id:wa.id,pageID:c('bs_js_primitive').is_nil_undef(ya)?undefined:ya.id,pageName:c('bs_js_primitive').is_nil_undef(za)?undefined:za.name,pageProfilePic:bb,preferredTimeRange:c('bs_js_primitive').is_nil_undef(db)?null:{end:db.end,start:db.start},price:c('bs_js_primitive').is_nil_undef(eb)?null:eb.experimental_freeform_price,requestedTime:wa.requested_time,serviceName:c('bs_js_primitive').is_nil_undef(fb)?null:fb.name,serviceProfilePic:hb,specialRequest:wa.special_request,status:wa.booking_status_value,statusLabel:wa.status,userID:c('bs_js_primitive').is_nil_undef(jb)?undefined:jb.id,username:c('bs_js_primitive').is_nil_undef(kb)?undefined:kb.short_name,userProfilePic:mb};}var ob=ra.message_bubble_type,pb;switch(ob){case "CANCELLED":pb=["Cancelled",h._("Cancelada")];break;case "DECLINED":pb=["Declined",h._("Rechazada")];break;case "REQUESTED":pb=["Requested",h._("Solicitud enviada")];break;case "SCHEDULEED":pb=["Scheduled",h._("Programada")];break;default:throw [c('bs_caml_builtin_exceptions').invalid_argument,"Erroneous target status"];}return {id:ra.id,pageID:va[0],calendarSyncType:va[1],ctaID:va[2],hasServiceConfig:va[3],userID:ra.user.id,status:pb[0],statusLabel:pb[1],viewerID:c('CurrentUser').getAccountID(),requestMetadata:xa};}function ca(ra){return {live_location_id:ra.live_location_id,is_expired:c('bs_js_boolean').to_js_boolean(ra.is_expired)};}function da(ra){var sa=ra.first_metaline;return {desc:ra.description,id:ra.id,image_aspect_ratio:ra.image_aspect_ratio,item_url:ra.target_url,metalines:c('bs_js_primitive').is_nil_undef(sa)?{}:{metaline_1:sa},name:ra.name,source:ra.source_name,text:ra.description,thumb_url:ra.image_url,title:ra.name,call_to_actions:i(ra.call_to_actions)};}function ea(ra){var sa=c('bs_array').map(da,ra.business_items.nodes),ta=i(ra.call_to_actions);return {message:ra.message,call_to_actions:ta,items:sa};}function fa(ra){return {message:ra.message,call_to_actions:i(ra.call_to_actions),items:c('bs_array').map(da,ra.promotion_items.nodes)};}function ga(ra){var sa=ra.partner_logo;return {account_holder_name:ra.account_holder_name,adjustments:c('bs_array').map(function(ta){return {adjustment_type:ta.adjustment_type,display_adjustment_amount:ta.adjustment_amount};},ra.adjustments),cancellation_url:ra.cancellation_url,items:c('bs_array').map(da,ra.items.nodes),merchant_name:ra.merchant_name,messenger_commerce_bubble_type:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('MNCommerceBubbleType')[ra.messenger_commerce_bubble_type])),order_id:ra.order_id,order_time:ra.order_time,order_url:ra.order_url,payment_method:ra.payment_method,receipt_id:ra.receipt_id,recipient_name:ra.recipient_name,shipping_cost:ra.shipping_cost,shipping_method:ra.shipping_method,status:ra.status,structured_address:{city:ra.structured_address.city,state:ra.structured_address.state,country:ra.structured_address.country,postal_code:ra.structured_address.postal_code,street_1:c('bs_caml_array').caml_array_get(ra.structured_address.streets,0),street_2:c('bs_caml_array').caml_array_get(ra.structured_address.streets,1)},subtotal:ra.subtotal,total_cost:ra.total_cost,total_tax:ra.total_tax,partner_logo:c('bs_js_primitive').is_nil_undef(sa)?undefined:sa.uri};}function ha(ra){return {snippet:ra.snippet};}function ia(ra){return {snippet:ra.snippet};}function ja(ra,sa){return {payment_modules_client:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('PaymentModulesClient')[sa.payment_modules_client])),is_viewer_seller:sa.is_viewer_seller,payment_snippet:sa.payment_snippet,item_list:c('bs_array').map(function(ta){return {item_id:ta.item_id,name:ta.name,subtitle:ta.subtitle,description:ta.description,unit_price:ta.unit_price,image_urls:c('bs_array').map(function(ua){return ua.uri;},ta.images),quantity:ta.quantity};},sa.item_list),components:sa.components,payment_call_to_actions:sa.payment_call_to_actions,click_action:sa.click_action,actor_id:ra,invoicer_id:sa.invoicer_id};}var ka=function ra(sa){var ta={},ua=[];for(var va=sa.field_data_list,wa=Array.isArray(va),xa=0,va=wa?va:va[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var ya;if(wa){if(xa>=va.length)break;ya=va[xa++];}else{xa=va.next();if(xa.done)break;ya=xa.value;}var za=ya,ab=za.field_type,bb=za.label,cb=za.values;if(ab===LeadGenInfoFieldTypes.CUSTOM){ua.push({label:bb,values:cb});}else ta[ab]={label:bb,values:cb};}ta.questions=ua;return ta;};function la(ra,sa){var ta=sa.invite_recipient,ua=c('bs_js_primitive').is_nil_undef(ta)?null:ta.id,va=sa.invite_sender,wa=c('bs_js_primitive').is_nil_undef(va)?null:va.id;return {quick_invite_id:sa.id,recipient_id:ua,sender_id:wa,is_viewer_recipient:c('bs_js_boolean').to_js_boolean(+(ra===ua))};}function ma(ra){var sa=ra.receiver_profile,ta;if(c('bs_js_primitive').is_nil_undef(sa)){ta=null;}else{var ua=sa.profile_picture;ta={id:sa.id,name:sa.short_name,full_name:sa.name,picture:c('bs_js_primitive').is_nil_undef(ua)?null:ua.uri,profile_url:sa.url};}var va=ra.sender,wa;if(c('bs_js_primitive').is_nil_undef(va)){wa={};}else{var xa=va.profile_picture;wa={id:va.id,name:va.name,full_name:va.full_name,picture:c('bs_js_primitive').is_nil_undef(xa)?null:xa.uri,profile_uri:va.url};}var ya=ra.transfer_context,za;if(c('bs_js_primitive').is_nil_undef(ya)){za=[null,null,null];}else{var ab=ya.transfer_theme;za=[ya.memoText,c('bs_array').map(function(db){var eb=db.image;if(c('bs_js_primitive').is_nil_undef(eb)){return null;}else return eb.uri;},ya.memo_images),c('bs_js_primitive').is_nil_undef(ab)?null:ab.id];}var bb=ra.platform_item,cb=c('bs_js_primitive').is_nil_undef(bb)?null:{name:bb.name,description:bb.description,image:c('bs_array').map(function(db){var eb=db.image;if(c('bs_js_primitive').is_nil_undef(eb)){return null;}else return eb.uri;},bb.photos),refURL:bb.url};return {sender:wa,amountWithSymbol:ra.transaction_amount.formatted_amount,status:c('bs_js_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('P2PTransferStatus')[ra.transfer_status])),receiver:ta,transfer_id:ra.transfer_id,completedTime:ra.completedTime,updatedTime:ra.updatedTime,creationTime:ra.creationTime,amount:ra.transaction_amount.amount,memoText:za[0],memoPhotoURLs:za[1],themeID:za[2],discountAmount:ra.amount_fb_discount.formatted,fundsAvailability:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('FundsAvailability')[ra.funds_availability])),groupThreadFBID:ra.group_thread_fbid,platform_item:cb,statusDescription:{markup:ra.status_description}};}function na(ra){var sa=ra.requester,ta;if(c('bs_js_primitive').is_nil_undef(sa)){ta=undefined;}else{var ua=sa.profile_picture;ta={id:sa.id,name:sa.short_name,full_name:sa.name,picture:c('bs_js_primitive').is_nil_undef(ua)?null:ua.uri,profile_url:sa.url};}var va=ra.requestee,wa;if(c('bs_js_primitive').is_nil_undef(va)){wa=undefined;}else{var xa=va.profile_picture;wa={id:va.id,name:va.short_name,full_name:va.name,picture:c('bs_js_primitive').is_nil_undef(xa)?null:xa.uri,profile_url:va.url};}var ya=c('bs_js_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('P2PPaymentRequestStatus')[ra.request_status])),za=ra.transfer,ab=c('bs_js_primitive').is_nil_undef(za)?[null,""]:[ma(za),za.id],bb=ra.request_theme;return {amount:ra.transaction_amount.amount,amountWithSymbol:ra.amount.formatted,requestee:wa,requester:ta,currentStatus:ya,currency:ra.amount.currency,creationTime:ra.creation_time,groupThreadFBID:ra.group_thread_fbid,id:ra.id,memoText:ra.memo_text,themeID:c('bs_js_primitive').is_nil_undef(bb)?null:bb.id,transfer:ab[0],transferID:ab[1],updatedTime:ra.updated_time,statusDescription:{markup:ra.status_description}};}function oa(ra){var sa=na({amount:ra.amount,transaction_amount:ra.transaction_amount,requester:ra.requester,requestee:ra.requestee,request_status:ra.request_status,request_theme:ra.request_theme,id:ra.id,memo_text:ra.memo_text,transfer:ra.transfer,creation_time:ra.creation_time,group_thread_fbid:ra.group_thread_fbid,updated_time:ra.updated_time,status_description:ra.status_description}),ta={individualRequests:c('bs_array').map(na,ra.individual_requests)};return Object.assign(sa,ta);}function pa(ra,sa){var ta=sa.media,ua=c('bs_js_primitive').is_nil_undef(ta)?null:ta.animated_image,va=c('bs_js_primitive').is_nil_undef(ta)?null:ta.image,wa={};c('bs_array').iter(function(lb){var mb=lb.value;wa[lb.key]=c('bs_js_primitive').is_nil_undef(mb)?null:mb.text;return 0;},sa.properties);var xa=sa.target,ya;if(c('bs_js_primitive').is_nil_undef(xa)){ya=null;}else switch(xa.tag|0){case 0:ya=ma(xa[0]);break;case 1:ya=oa(xa[0]);break;case 2:ya=ja(ra,xa[0]);break;case 3:ya=ia(xa[0]);break;case 4:ya=ha(xa[0]);break;case 5:ya=fa(xa[0]);break;case 6:ya=ea(xa[0]);break;case 7:ya={video_id:xa[0].video_id};break;case 8:ya=ka(xa[0]);break;case 9:ya=ca(xa[0]);break;case 10:ya=la(ra,xa[0]);break;case 11:ya=ba(xa[0]);break;case 12:var za=xa[0],ab=za.genie_sender,bb=c('bs_js_primitive').is_nil_undef(ab)?[null,null]:[ab.messaging_actor.id,ab.messaging_actor.name],cb=bb[0],db=za.story_attachment,eb=c('bs_js_primitive').is_nil_undef(db)?null:qa(ra,{legacy_attachment_id:cb,story_attachment:{action_links:db.action_links,messaging_attribution:db.messaging_attribution,deduplication_key:db.deduplication_key,description:db.description,media:db.media,properties:db.properties,source:db.source,style_list:db.style_list,title_with_entities:db.title_with_entities,url:db.url,subattachments:[],target:null}});ya={genie_id:cb,genie_name:bb[1],attachment:eb};break;case 13:ya=aa(xa[0]);break;case 14:ya=w(xa[0]);break;case 15:var fb=xa[0];ya={lwa_state:fb.lwa_state,lwa_type:fb.lwa_type};break;case 16:ya=z(xa[0]);break;case 17:ya=x(xa[0]);break;case 18:ya=y(xa[0]);break;case 19:ya=ga(xa[0]);break;case 20:ya={id:xa[0].id};break;case 21:ya=v(xa[0]);break;case 22:ya=u(ra,xa[0]);break;case 23:ya={is_active:xa[0].is_active};break;case 24:ya=t(xa[0]);break;case 25:ya=s(xa[0]);break;case 26:ya=r(xa[0]);break;case 27:ya=q(xa[0]);break;case 28:ya=p(xa[0]);break;case 29:ya=o(xa[0]);break;}var gb=sa.target,hb=!c('bs_js_primitive').is_nil_undef(gb)&&gb.tag===5?0:null,ib=sa.description,jb=sa.source,kb=sa.title_with_entities;return {description:c('bs_js_primitive').is_nil_undef(ib)?null:ib.text,media:{animated_image:c('bs_js_primitive').is_nil_undef(ua)?null:ua.uri,animated_image_size:c('bs_js_primitive').is_nil_undef(ua)?{height:null,width:null}:{height:ua.height,width:ua.width},image:c('bs_js_primitive').is_nil_undef(va)?null:va.uri,image_size:c('bs_js_primitive').is_nil_undef(va)?{height:null,width:null}:{height:va.height,width:va.width},duration:c('bs_js_primitive').is_nil_undef(ta)?null:ta.playable_duration,playable:c('bs_js_primitive').is_nil_undef(ta)?null:ta.is_playable,source:c('bs_js_primitive').is_nil_undef(ta)?null:ta.playable_url},source:c('bs_js_primitive').is_nil_undef(jb)?null:jb.text,style_list:sa.style_list,title:c('bs_js_primitive').is_nil_undef(kb)?null:kb.text,action_links:j(sa.action_links),messaging_attribution:sa.messaging_attribution,properties:wa,uri:sa.url,deduplication_key:sa.deduplication_key,target:ya,label:hb};}function qa(ra,sa){var ta=sa.story_attachment,ua;if(c('bs_js_primitive').is_nil_undef(ta)){ua=null;}else{var va={share_id:sa.legacy_attachment_id,subattachments:c('bs_array').map(function(xa){return pa(ra,xa);},ta.subattachments)},wa={description:ta.description,media:ta.media,source:ta.source,style_list:ta.style_list,title_with_entities:ta.title_with_entities,properties:ta.properties,url:ta.url,deduplication_key:ta.deduplication_key,action_links:ta.action_links,messaging_attribution:ta.messaging_attribution,target:ta.target};ua=Object.assign(va,pa(ra,wa));}return {app_attribution:null,attach_type:c('MercuryAttachmentType').SHARE,name:null,url:null,rel:null,preview_url:null,preview_width:null,preview_height:null,large_preview_url:null,large_preview_width:null,large_preview_height:null,icon_type:null,metadata:null,share:ua,thumbnail_url:null};}g._getCallToActions=i;g._getActionLinks=j;g._getColor=k;g._getLogo=l;g._getCommerceLocation=n;g._getMessengerRetailShipmentTarget=o;g._getShipmentTrackingEventTarget=p;g._getAirlineItineraryMessageTarget=q;g._getAirlineUpdateMessageTarget=r;g._getAirlineCheckInReminderTarget=s;g._getAirlineBoardingPassCollectionTarget=t;g._getPageTarget=u;g._getGroupCommerceProductItemTarget=v;g._getExternalSongTarget=w;g._getAgentSuggestionItemTarget=x;g._getFundraiserTarget=y;g._getRetailItemTarget=z;g._getEventTarget=aa;g._getPagesPlatformBookingMessageTarget=ba;g._getMessageLiveLocationTarget=ca;g._getBusinessRetailItem=da;g._getMessengerBusinessMessageTarget=ea;g._getMessengerRetailPromotionTarget=fa;g._getMessengerRetailReceiptTarget=ga;g._getMomentsAppMessengerPhotoRequestTarget=ha;g._getMomentsAppMessengerInvitationTarget=ia;g._getPagesPlatformAttachmentTarget=ja;g._getPagesPlatformLeadGenInfoTarget=ka;g._getQuickInviteTarget=la;g._getP2PTransferTarget=ma;g._getP2PTransferRequestTarget=na;g._getP2PTransferRequestWithIndividualRequests=oa;g.transformStoryAttachment=pa;g.getExtensibleAttachmentPayload=qa;}),null);
__d('messengerAttachmentTransformerRe',['fbt','bs_array','bs_js_boolean','bs_pervasives','bs_js_primitive','MercuryAttachmentType','MercuryAttachmentContentType','messengerStoryAttachmentTransformerRe'],(function a(b,c,d,e,f,g,h){'use strict';function i(q){if(q.is_malicious){return {app_attribution:null,icon_type:c('MercuryAttachmentContentType').UNKNOWN,metadata:null,name:null,preview_height:null,preview_url:null,preview_width:null,rel:null,share:null,thumbnail_url:null,url:null,attach_type:c('MercuryAttachmentType').ERROR,error_msg:h._("Se marc\u00f3 este archivo adjunto como malicioso."),url_shimhash:null,url_skipshim:null};}else{var r=q.attribution_app,s;if(c('bs_js_primitive').is_nil_undef(r)){s=null;}else{var t=r.square_logo;s={id:r.id,icon_url:c('bs_js_primitive').is_nil_undef(t)?null:t.uri,metadata:q.attribution_metadata,name:r.name};}var u=q.url;return {app_attribution:s,icon_type:q.content_type,metadata:null,name:q.filename,preview_height:null,preview_url:null,preview_width:null,rel:"ignore",share:null,thumbnail_url:null,url:c('bs_js_primitive').is_nil_undef(u)?null:u,attach_type:c('MercuryAttachmentType').FILE,error_msg:undefined,url_shimhash:q.url_shimhash,url_skipshim:q.url_skipshim};}}function j(q,r,s){var t=q.chat_image,u=c('bs_js_primitive').is_nil_undef(t)?[null,null,null]:[t.uri,t.width,t.height],v=u[0],w=q.chat_image,x=c('bs_js_primitive').is_nil_undef(w)?null:{width:w.width,height:w.height},y=q.large_image,z=c('bs_js_primitive').is_nil_undef(y)?[null,null]:[y.uri,{width:y.width,height:y.height}],aa=q.inbox_image,ba=c('bs_js_primitive').is_nil_undef(aa)?[null,null]:[aa.uri,{width:aa.width,height:aa.height}],ca=q.attribution_app,da;if(c('bs_js_primitive').is_nil_undef(ca)){da=null;}else{var ea=ca.square_logo;da={id:ca.id,icon_url:c('bs_js_primitive').is_nil_undef(ea)?null:ea.uri,metadata:q.attribution_metadata,name:ca.name};}return {app_attribution:da,attach_type:c('MercuryAttachmentType').VIDEO,name:q.filename,url:q.playable_url,rel:"async",preview_url:v,preview_width:u[1],preview_height:u[2],large_preview_url:null,large_preview_width:null,large_preview_height:null,icon_type:c('MercuryAttachmentContentType').VIDEO,metadata:{fbid:q.legacy_attachment_id,render_as_sticker:c('bs_js_boolean').to_js_boolean(+(q.video_type==="SPEAKING_STICKER")),dimensions:{width:q.original_dimensions.x,height:q.original_dimensions.y},duration:q.playable_duration_in_ms,large_size:z[1],large_preview:z[0],chat_size:x,chat_preview:v,inbox_size:ba[1],inbox_preview:ba[0],pageid:s?r:undefined},thumbnail_url:v,share:null};}function k(q){var r=q.attribution_app,s;if(c('bs_js_primitive').is_nil_undef(r)){s=null;}else{var t=r.square_logo;s={id:r.id,icon_url:c('bs_js_primitive').is_nil_undef(t)?null:t.uri,metadata:q.attribution_metadata,name:r.name};}return {app_attribution:s,attach_type:c('MercuryAttachmentType').FILE,name:q.filename,url:q.playable_url,rel:"ignore",preview_url:null,preview_width:null,preview_height:null,large_preview_url:null,large_preview_width:null,large_preview_height:null,icon_type:c('MercuryAttachmentContentType').MUSIC,metadata:{duration:q.playable_duration_in_ms,isVoicemail:q.is_voicemail?"1":"0",type:q.audio_type==="VOICE_MESSAGE"?"fb_voice_message":q.audio_type==="VOICE_MESSAGE_WITH_TRANSCRIPT"?"fb_voice_message_with_transcript":"file_attachment"},thumbnail_url:null,share:null,url_shimhash:q.url_shimhash,url_skipshim:q.url_skipshim};}function l(q,r,s){var t=q.preview_image,u=c('bs_js_primitive').is_nil_undef(t)?[null,null,null]:[t.uri,t.width,t.height],v=q.animated_image,w=c('bs_js_primitive').is_nil_undef(v)?null:v.uri,x=q.attribution_app,y;if(c('bs_js_primitive').is_nil_undef(x)){y=null;}else{var z=x.square_logo;y={id:x.id,icon_url:c('bs_js_primitive').is_nil_undef(z)?null:z.uri,metadata:q.attribution_metadata,name:x.name};}return {app_attribution:y,attach_type:c('MercuryAttachmentType').ANIMATED_IMAGE,name:q.filename,url:w,rel:"async",preview_url:u[0],preview_width:u[1],preview_height:u[2],large_preview_url:null,large_preview_width:null,large_preview_height:null,icon_type:c('MercuryAttachmentContentType').PHOTO,metadata:{fbid:q.legacy_attachment_id,image:w,dimensions:c('bs_pervasives').string_of_int(q.original_dimensions.x)+(","+c('bs_pervasives').string_of_int(q.original_dimensions.y)),pageid:s?r:undefined},thumbnail_url:w,share:null};}function m(q){var r=q.original_extension==="gif"?c('MercuryAttachmentType').ANIMATED_IMAGE:q.render_as_sticker?c('MercuryAttachmentType').THIRDPARTYSTICKER:c('MercuryAttachmentType').PHOTO,s=q.preview,t=c('bs_js_primitive').is_nil_undef(s)?[null,null,null]:[s.uri,s.width,s.height],u;if(r===c('MercuryAttachmentType').PHOTO){var v=q.large_preview;u=c('bs_js_primitive').is_nil_undef(v)?[null,null,null]:[v.uri,v.width,v.height];}else u=[null,null,null];var w=q.attribution_app,x;if(c('bs_js_primitive').is_nil_undef(w)){x=null;}else{var y=w.square_logo;x={id:w.id,icon_url:c('bs_js_primitive').is_nil_undef(y)?null:y.uri,metadata:q.attribution_metadata,name:w.name};}var z=q.thumbnail;return {app_attribution:x,attach_type:r,name:q.filename,url:null,rel:"async",preview_url:t[0],preview_width:t[1],preview_height:t[2],large_preview_url:u[0],large_preview_width:u[1],large_preview_height:u[2],icon_type:c('MercuryAttachmentContentType').PHOTO,metadata:{fbid:q.legacy_attachment_id,dimensions:c('bs_pervasives').string_of_int(q.original_dimensions.x)+(","+c('bs_pervasives').string_of_int(q.original_dimensions.y))},thumbnail_url:c('bs_js_primitive').is_nil_undef(z)?null:z.uri,share:null};}function n(q,r){var s=r,t=q;if(q>=r){var u=c('bs_pervasives').min(120,t/2),v=u/(t/2);return [u|0,s/2*v|0];}else{var w=c('bs_pervasives').min(120,s/2),x=w/(s/2);return [t/2*x|0,w|0];}}function o(q){var r=n(q.width,q.height),s=q.pack,t=q.sprite_image,u=q.sprite_image_2x,v=q.padded_sprite_image,w=q.padded_sprite_image_2x;return {app_attribution:null,attach_type:c('MercuryAttachmentType').STICKER,name:null,url:q.url,rel:null,preview_url:null,preview_width:null,preview_height:null,large_preview_url:null,large_preview_width:null,large_preview_height:null,icon_type:c('MercuryAttachmentContentType').UNKNOWN,metadata:{accessibilityLabel:q.label,stickerID:q.id,packID:c('bs_js_primitive').is_nil_undef(s)?null:s.id,frameCount:q.frame_count,frameRate:q.frame_rate,framesPerRow:q.frame_count>1?q.frames_per_row:1,framesPerCol:q.frame_count>1?q.frames_per_column:1,height:r[1],width:r[0],spriteURI:c('bs_js_primitive').is_nil_undef(t)?null:t.uri,spriteURI2x:c('bs_js_primitive').is_nil_undef(u)?null:u.uri,paddedSpriteURI:c('bs_js_primitive').is_nil_undef(v)?null:v.uri,paddedSpriteURI2x:c('bs_js_primitive').is_nil_undef(w)?null:w.uri,thumbnail_url:null,share:null}};}function p(q,r,s){var t=[],u=r.extensible_attachment;if(!c('bs_js_primitive').is_nil_undef(u))t.push(c('messengerStoryAttachmentTransformerRe').getExtensibleAttachmentPayload(q,u));var v=r.sticker;if(!c('bs_js_primitive').is_nil_undef(v))t.push(o(v));var w=r.blob_attachments;if(!c('bs_js_primitive').is_nil_undef(w))c('bs_array').iter(function(x){switch(x.tag|0){case 0:t.push(m(x[0]));return 0;case 1:t.push(l(x[0],q,s));return 0;case 2:t.push(k(x[0]));return 0;case 3:t.push(j(x[0],q,s));return 0;case 4:t.push(i(x[0]));return 0;}},w);return t;}g._getFilePayload=i;g._getVideoPayload=j;g._getAudioPayload=k;g._getAnimatedImagePayload=l;g._getImagePayload=m;g._getStickerDimensions=n;g._getStickerPayload=o;g.transformAttachment=p;}),null);
__d("MessengerThreadsWebGraphQLQuery",["WebGraphQLQueryBase"],(function a(b,c,d,e,f,g){'use strict';f.exports=function(){var h,i;h=babelHelpers.inherits(j,c("WebGraphQLQueryBase"));i=h&&h.prototype;j.__getDocID=function(){"use strict";return "1527774147243246";};j.getQueryID=function(){"use strict";return "1810329682611307";};function j(){"use strict";h.apply(this,arguments);}return j;}();}),null);
__d('messengerMessageTransformerRe',['FBID','bs_array','bs_block','bs_string','getByPath','bs_js_boolean','MercuryIDs','bs_pervasives','bs_caml_format','CurrentUser','bs_js_primitive','MessagingTag','bs_js_null_undefined','MercuryActionType','MessagingTagUtils','MessagingSourceEnum','StoryAttachmentStyle','MNCommerceMessageType','MercuryLogMessageType','MessagingGenericAdminTextType','InstantGameUpdateXMATUpdateType','messengerAttachmentTransformerRe'],(function a(b,c,d,e,f,g){'use strict';function h(o,p,q){var r;if(o.__typename==="GroupPollExtensibleMessageAdminText"){var s=Object.assign({},o.question);Object.assign(s,{total_count:o.total_count,options:c('bs_array').map(function(t){var u=Object.assign({},t);return Object.assign(u,{total_count:t.voters.nodes.length,voters:c('bs_array').map(function(v){return v.id;},t.voters.nodes)});},o.question.options.nodes)});r={message_type:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('MessagingGenericAdminTextType')[p])),untypedData:{event_type:c('bs_string').lowercase(o.event_type),question_id:o.question.id,question_json:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(JSON.stringify(s)))}};}else r=o.__typename==="InstantGameUpdateExtensibleMessageAdminText"?{message_type:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('MessagingGenericAdminTextType')[p])),untypedData:{game_id:c('getByPath')(o,["game","id"]),update_type:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('InstantGameUpdateXMATUpdateType')[o.update_type])),collapsed_text:o.collapsed_text,expanded_text:o.expanded_text,cta_url:c('getByPath')(o,["instant_game_update_data","cta_url"]),cta_title:c('getByPath')(o,["instant_game_update_data","cta_title"]),custom_image_url:c('getByPath')(o,["instant_game_update_data","photo","image","uri"])}}:o.__typename==="ThemeColorExtensibleMessageAdminText"||o.__typename==="ThreadIconExtensibleMessageAdminText"||o.__typename==="ThreadNicknameExtensibleMessageAdminText"||o.__typename==="AcceptPendingThreadExtensibleMessageAdminText"||o.__typename==="AddContactExtensibleMessageAdminText"||o.__typename==="RtcCallLogExtensibleMessageAdminText"||o.__typename==="GameScoreExtensibleMessageAdminText"||o.__typename==="ConfirmFriendRequestExtensibleMessageAdminText"||o.__typename==="PartiesInviteExtensibleMessageAdminText"?{message_type:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('MessagingGenericAdminTextType')[p])),untypedData:Object.assign({},o)}:{message_type:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('MessagingGenericAdminTextType')[p])),untypedData:undefined};return {log_message_body:q,log_message_data:r,log_message_type:c('MercuryLogMessageType').GENERIC_ADMIN_TEXT};}function i(o){return c('bs_array').map(function(p){if(p==="p2p_transfer"){return c('StoryAttachmentStyle').ORION;}else if(p==="p2p_payment_request"){return c('StoryAttachmentStyle').ORION_REQUEST;}else return p;},o);}function j(o){var p=o.target,q;if(c('bs_js_primitive').is_nil_undef(p)){q=null;}else if(p.__typename==="PeerToPeerTransfer"){q=c('bs_block').__(0,[{sender:p.sender,receiver_profile:p.receiver_profile,transaction_amount:p.transaction_amount,transfer_status:p.transfer_status,transfer_id:p.transfer_id,completedTime:p.completedTime,updatedTime:p.updatedTime,creationTime:p.creationTime,transfer_context:p.transfer_context,amount_fb_discount:p.amount_fb_discount,funds_availability:p.funds_availability,group_thread_fbid:p.group_thread_fbid,platform_item:p.platform_item,id:p.id,status_description:p.status_description}]);}else if(p.__typename==="PeerToPeerPaymentRequest"){q=c('bs_block').__(1,[{amount:p.amount,transaction_amount:p.transaction_amount,requester:p.requester,requestee:p.requestee,request_status:p.request_status,request_theme:p.request_theme,id:p.id,memo_text:p.memo_text,transfer:p.transfer,creation_time:p.creation_time,group_thread_fbid:p.group_thread_fbid,updated_time:p.updated_time,status_description:p.status_description,individual_requests:p.individual_requests}]);}else if(p.__typename==="PaymentPlatformAttachment"){q=c('bs_block').__(2,[{payment_modules_client:p.payment_modules_client,is_viewer_seller:p.is_viewer_seller,payment_snippet:p.payment_snippet,item_list:p.item_list,components:p.components,payment_call_to_actions:p.payment_call_to_actions,click_action:p.click_action,invoicer_id:p.invoicer_id}]);}else if(p.__typename==="MomentsAppMessengerInvitation"){q=c('bs_block').__(3,[{snippet:p.snippet}]);}else if(p.__typename==="MomentsAppMessengerPhotoRequest"){q=c('bs_block').__(4,[{snippet:p.snippet}]);}else if(p.__typename==="MessengerRetailPromotion"){q=c('bs_block').__(5,[{message:p.message,call_to_actions:p.call_to_actions,promotion_items:p.promotion_items}]);}else if(p.__typename==="MessengerBusinessMessage"){q=c('bs_block').__(6,[{message:p.message,call_to_actions:p.call_to_actions,business_items:p.business_items}]);}else if(p.__typename==="Video"){q=c('bs_block').__(7,[{video_id:p.video_id}]);}else if(p.__typename==="PagesPlatformLeadGenInfo"){q=c('bs_block').__(8,[{field_data_list:p.field_data_list}]);}else if(p.__typename==="MessageLiveLocation"){q=c('bs_block').__(9,[{live_location_id:p.live_location_id,is_expired:p.is_expired}]);}else if(p.__typename==="QuickInvite"){q=c('bs_block').__(10,[{id:p.id,invite_sender:p.invite_sender,invite_recipient:p.invite_recipient}]);}else if(p.__typename==="PagesPlatformBookingMessage"){q=c('bs_block').__(11,[{id:p.id,page:p.page,message_bubble_type:p.message_bubble_type,user:p.user,native_component_flow_request:p.native_component_flow_request}]);}else if(p.__typename==="GenieMessage"){q=c('bs_block').__(12,[{genie_sender:p.genie_sender,story_attachment:p.story_attachment}]);}else if(p.__typename==="Event"){q=c('bs_block').__(13,[{eventID:p.eventID,guestStatus:p.guestStatus,canViewerJoin:p.canViewerJoin,timeString:p.timeString,event_place:p.event_place,social_context:p.social_context,watchStatus:p.watchStatus,connection_style:p.connection_style,canViewerWatch:p.canViewerWatch}]);}else if(p.__typename==="ExternalSong"){q=c('bs_block').__(14,[{application_name:p.application_name,artist_names:p.artist_names,audio_url:p.audio_url,duration_ms:p.duration_ms,music_title:p.music_title}]);}else if(p.__typename==="LightweightAction"){q=c('bs_block').__(15,[{lwa_state:p.lwa_state,lwa_type:p.lwa_type}]);}else if(p.__typename==="MessengerRetailItem"){q=c('bs_block').__(16,[{id:p.id,name:p.name,desc:p.desc,thumb_url:p.thumb_url,item_url:p.item_url,source:p.source,image_aspect_ratio:p.image_aspect_ratio,first_metaline:p.first_metaline,second_metaline:p.second_metaline,third_metaline:p.third_metaline,call_to_actions:p.call_to_actions}]);}else if(p.__typename==="AgentItemSuggestion"){q=c('bs_block').__(17,[{id:p.id,desc:p.desc,total_cost:p.total_cost,merchant_name:p.merchant_name,target_url:p.target_url,thumb_url:p.thumb_url,raw_amount:p.raw_amount,payment:p.payment,price_amount:p.price_amount,price_currency:p.price_currency,name:p.name}]);}else if(p.__typename==="FundraiserPersonToCharity"||p.__typename==="FundraiserPersonForPerson"){var r=p.fundraiser_detailed_progress_text,s=p.fundraiser_subtitle_text,t=p.focused_cover_photo;q=c('bs_block').__(18,[{id:p.id,canDonate:p.can_donate,hadViewerDonated:p.has_viewer_donated,fundraiserDetailedProgressText:c('bs_js_primitive').is_nil_undef(r)?null:r.text,fundraiserSubtitleText:c('bs_js_primitive').is_nil_undef(s)?null:s.text,focusedCoverPhoto:c('bs_js_primitive').is_nil_undef(t)?null:{src:t.photo.image.uri,data:{height:t.photo.image.height,width:t.photo.image.width}}}]);}else q=p.__typename==="MessengerRetailReceipt"?c('bs_block').__(19,[{account_holder_name:p.account_holder_name,adjustments:p.retail_adjustments,cancellation_url:p.cancellation_url,items:p.retail_items,merchant_name:p.merchant_name,messenger_commerce_bubble_type:p.bubble_type,order_id:p.receipt_id,order_time:p.order_time_for_display,order_url:p.receipt_url,payment_method:p.order_payment_method,receipt_id:p.id,recipient_name:p.recipient_name,shipping_cost:p.shipping_cost,shipping_method:p.shipping_method,status:p.status,structured_address:p.structured_address,subtotal:p.subtotal,total_cost:p.total,total_tax:p.tax,partner_logo:p.partner_log}]):p.__typename==="JobApplication"?c('bs_block').__(20,[{id:p.id}]):p.__typename==="GroupCommerceProductItem"?c('bs_block').__(21,[{group_commerce_item_description:p.group_commerce_item_description,group_commerce_item_seller:p.group_commerce_item_seller,formatted_price:p.formatted_price,group_commerce_item_title:p.group_commerce_item_title,primary_photo:p.primary_photo,url:p.url}]):p.__typename==="Page"?c('bs_block').__(22,[{address:p.address,top_category_name:p.top_category_name,cover_photo:p.cover_photo,location:p.location,name:p.name,overall_star_rating:p.overall_star_rating,id:p.id,price_range_description:p.price_range_description}]):p.__typename==="MessengerEventReminder"?c('bs_block').__(23,[{is_active:p.is_active}]):p.__typename==="AirlineBoardingPassCollectionMessageAttachment"?c('bs_block').__(24,[{tint_color:p.tint_color,logo:p.logo,flight_label:p.flight_label,boarding_time_label:p.boarding_time_label,departure_label:p.departure_label,passenger_names_label:p.passenger_names_label,passenger_seat_label:p.passenger_seat_label,flight_terminal_label:p.flight_terminal_label,flight_gate_label:p.flight_gate_label,view_boarding_pass_cta_label:p.view_boarding_pass_cta_label,boarding_passes:p.boarding_passes,share_cta_label:p.share_cta_label,message_cta_label:p.message_cta_label,boarding_pass_title_label:p.boarding_pass_title_label,boarding_pass_error_title_label:p.boarding_pass_error_title_label}]):p.__typename==="AirlineCheckInReminderMessageAttachment"?c('bs_block').__(25,[{pnr_number:p.pnr_number,tint_color:p.tint_color,checkin_url:p.checkin_url,booking_number_label:p.booking_number_label,flight_label:p.flight_label,arrival_time_label:p.arrival_time_label,departure_time_label:p.departure_time_label,checkin_cta_label:p.checkin_cta_label,logo:p.logo,flight_infos:p.flight_infos}]):p.__typename==="AirlineUpdateMessageAttachment"?c('bs_block').__(26,[{pnr_number:p.pnr_number,tint_color:p.tint_color,update_type:p.update_type,departure_time_label:p.departure_time_label,arrival_time_label:p.arrival_time_label,booking_number_label:p.booking_number_label,flight_gate_label:p.flight_gate_label,flight_label:p.flight_label,flight_status_label:p.flight_status_label,passenger_names_label:p.passenger_names_label,passenger_seat_label:p.passenger_seat_label,logo:p.logo,flight_info:p.flight_info,hightlighted_labels:p.hightlighted_labels}]):p.__typename==="AirlineItineraryMessageAttachment"?c('bs_block').__(27,[{confirmation_number:p.confirmation_number,pnr_number:p.pnr_number,tint_color:p.tint_color,formatted_total:p.formatted_total,itemized_price_infos:p.itemized_price_infos,formatted_tax:p.formatted_tax,formatted_base_price:p.formatted_base_price,passenger_infos:p.passenger_infos,logo:p.logo,aircraft_type_label:p.aircraft_type_label,arrival_time_label:p.arrival_time_label,base_price_label:p.base_price_label,booking_number_label:p.booking_number_label,cabin_type_label:p.cabin_type_label,departure_time_label:p.departure_time_label,flight_confirmation_label:p.flight_confirmation_label,flight_date_label:p.flight_date_label,flight_label:p.flight_label,flight_terminal_label:p.flight_terminal_label,itinerary_error_title_label:p.itinerary_error_title_label,itinerary_title_label:p.itinerary_title_label,passenger_name_label:p.passenger_name_label,passenger_names_label:p.passenger_names_label,passenger_seat_label:p.passenger_seat_label,purchase_summary_label:p.purchase_summary_label,taxes_label:p.taxes_label,total_label:p.total_label,view_details_cta_label:p.view_details_cta_label,itinerary_legs:p.itinerary_legs}]):p.__typename==="MessengerRetailShipmentTrackingEvent"?c('bs_block').__(28,[{id:p.id,shipment:p.shipment,tracking_event_time_for_display:p.tracking_event_time_for_display,shipment_tracking_event_type:p.shipment_tracking_event_type,messenger_commerce_location:p.messenger_commerce_location,tracking_event_description:p.tracking_event_description,bubble_type:p.bubble_type}]):p.__typename==="MessengerRetailShipment"?c('bs_block').__(29,[{id:p.id,tracking_number:p.tracking_number,shipdate_for_display:p.shipdate_for_display,estimated_delivery_time_for_display:p.estimated_delivery_time_for_display,commerce_origin:p.commerce_origin,commerce_destination:p.commerce_destination,retail_carrier:p.retail_carrier,shipment_tracking_events:p.shipment_tracking_events,receipt:p.receipt,recipient:p.recipient,retail_shipment_items:p.retail_shipment_items,bubble_type:p.bubble_type}]):null;return {description:o.description,media:o.media,source:o.source,style_list:i(o.style_list),title_with_entities:o.title_with_entities,properties:o.properties,url:o.url,deduplication_key:o.deduplication_key,action_links:o.action_links,messaging_attribution:o.messaging_attribution,target:q};}function k(o){var p=j({description:o.description,media:o.media,source:o.source,style_list:o.style_list,title_with_entities:o.title_with_entities,properties:o.properties,url:o.url,deduplication_key:o.deduplication_key,action_links:o.action_links,messaging_attribution:o.messaging_attribution,target:o.target});if(c('bs_js_primitive').is_nil_undef(p)){return null;}else{var q=c('bs_array').map(j,o.subattachments);return Object.assign({subattachments:q},p);}}function l(o){var p=o.blob_attachments,q=[];if(!c('bs_js_primitive').is_nil_undef(p))c('bs_array').iter(function(r){if(r.__typename==="MessageImage"){q.push(c('bs_block').__(0,[{attribution_app:r.attribution_app,attribution_metadata:r.attribution_metadata,filename:r.filename,preview:r.preview,large_preview:r.large_preview,thumbnail:r.thumbnail,legacy_attachment_id:r.legacy_attachment_id,original_dimensions:r.original_dimensions,original_extension:r.original_extension,render_as_sticker:r.render_as_sticker}]));return 0;}else if(r.__typename==="MessageAnimatedImage"){q.push(c('bs_block').__(1,[{attribution_app:r.attribution_app,attribution_metadata:r.attribution_metadata,filename:r.filename,animated_image:r.animated_image,legacy_attachment_id:r.legacy_attachment_id,preview_image:r.preview_image,original_dimensions:r.original_dimensions}]));return 0;}else if(r.__typename==="MessageAudio"){q.push(c('bs_block').__(2,[{attribution_app:r.attribution_app,attribution_metadata:r.attribution_metadata,filename:r.filename,playable_url:r.playable_url,playable_duration_in_ms:r.playable_duration_in_ms,is_voicemail:r.is_voicemail,audio_type:r.audio_type,url_shimhash:r.url_shimhash,url_skipshim:r.url_skipshim}]));return 0;}else if(r.__typename==="MessageVideo"){q.push(c('bs_block').__(3,[{attribution_app:r.attribution_app,attribution_metadata:r.attribution_metadata,filename:r.filename,playable_url:r.playable_url,playable_duration_in_ms:r.playable_duration_in_ms,legacy_attachment_id:r.legacy_attachment_id,chat_image:r.chat_image,video_type:r.video_type,original_dimensions:r.original_dimensions,large_image:r.large_image,inbox_image:r.inbox_image}]));return 0;}else if(r.__typename==="MessageFile"){q.push(c('bs_block').__(4,[{attribution_app:r.attribution_app,attribution_metadata:r.attribution_metadata,filename:r.filename,url:r.url,content_type:r.content_type,is_malicious:r.is_malicious,url_shimhash:r.url_shimhash,url_skipshim:r.url_skipshim}]));return 0;}else return 0;},p);return q;}function m(o){var p=o.message;if(c('bs_js_primitive').is_nil_undef(p)){return [];}else{var q=[];c('bs_array').iter(function(r){var s=r.entity;if(c('bs_js_primitive').is_nil_undef(s)){return 0;}else{var t=s.id;if(c('bs_js_primitive').is_nil_undef(t)){return 0;}else{q.push({id:t,offset:r.offset,length:r.length});return 0;}}},p.ranges);return q;}}function n(o,p,q,r){var s={};c('bs_array').iter(function(qa){s[qa.user.id]=qa.reaction;return 0;},p.message_reactions);var t=+c('FBID').isUser(p.message_sender.id),u=t?c('MessagingTagUtils').getSourceFromTags(p.tags_list):c('MessagingSourceEnum').UNKNOWN,v=t?c('MessagingTagUtils').getSourceTags(p.tags_list,u):[],w=p.commerce_message_type,x=p.customizations,y={thread_id:q.thread_id,thread_fbid:q.thread_fbid,other_user_fbid:q.other_user_fbid,action_type:p.__typename==="UserMessage"?c('MercuryActionType').USER_GENERATED_MESSAGE:c('MercuryActionType').LOG_MESSAGE,message_id:p.message_id,threading_id:null,offline_threading_id:p.offline_threading_id,author:c('MercuryIDs').getParticipantIDFromUserID(p.message_sender.id),author_email:p.message_sender.email,ephemeral_ttl_mode:p.ttl,timestamp:c('bs_caml_format').caml_float_of_string(p.timestamp_precise),is_unread:p.unread,is_filtered_content:c('bs_js_boolean').to_js_boolean(+(p.tags_list.indexOf(c('MessagingTag').FILTERED_CONTENT)!==-1)),is_filtered_content_bh:c('bs_js_boolean').to_js_boolean(+(p.tags_list.indexOf(c('MessagingTag').FILTERED_CONTENT_BH)!==-1)),is_filtered_content_account:c('bs_js_boolean').to_js_boolean(+(p.tags_list.indexOf(c('MessagingTag').FILTERED_CONTENT_ACCOUNT)!==-1)),is_filtered_content_quasar:c('bs_js_boolean').to_js_boolean(+(p.tags_list.indexOf(c('MessagingTag').FILTERED_CONTENT_QUASAR)!==-1)),is_filtered_content_invalid_app:c('bs_js_boolean').to_js_boolean(+(p.tags_list.indexOf(c('MessagingTag').FILTERED_CONTENT_INVALID_APP)!==-1)),is_sponsored:p.is_sponsored,commerce_message_type:c('bs_js_primitive').is_nil_undef(w)?null:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('MNCommerceMessageType')[w])),customizations:c('bs_js_primitive').is_nil_undef(x)?[]:x,source:u,source_tags:v,tags:p.tags_list,is_spoof_warning:c('bs_js_boolean').to_js_boolean(+(p.tags_list.indexOf(c('MessagingTag').DOMAIN_AUTH_FAIL)!==-1||p.tags_list.indexOf(c('MessagingTag').SPAM_SPOOFING)!==-1||p.tags_list.indexOf(c('MessagingTag').SPOOF_WARNING)!==-1)),folder:q.folder,platform_xmd:p.platform_xmd_encoded,message_source:p.message_source_data,montage_reply_data:p.montage_reply_data,skip_bump_thread:false,profile_ranges:m(p),reactions:s};if(p.__typename==="UserMessage"){var z=l(p),aa=p.extensible_attachment,ba;if(c('bs_js_primitive').is_nil_undef(aa)){ba=null;}else{var ca=aa.story_attachment;ba={legacy_attachment_id:aa.legacy_attachment_id,story_attachment:c('bs_js_primitive').is_nil_undef(ca)?null:k(ca)};}var da=c('messengerAttachmentTransformerRe').transformAttachment(o,{extensible_attachment:ba,blob_attachments:z,sticker:p.sticker},r),ea=p.message;Object.assign(y,{body:c('bs_js_primitive').is_nil_undef(ea)?null:ea.text,subject:null,has_attachment:c('bs_js_boolean').to_js_boolean(+(da.length>0)),attachments:da,raw_attachments:null,ranges:undefined,meta_ranges:[]});}else if(p.__typename==="VoiceCallMessage"){var fa=p.message_sender.id,ga=q.other_user_fbid,ha=c('bs_js_primitive').is_nil_undef(ga)?null:c('MercuryIDs').getParticipantIDFromUserID(fa===ga?c('CurrentUser').getID():ga),ia=p.answered;Object.assign(y,{log_message_type:c('MercuryLogMessageType').PHONE_CALL,log_message_data:{answered:c('bs_js_primitive').is_nil_undef(ia)?false:ia,caller:c('MercuryIDs').getParticipantIDFromUserID(fa),callee:ha},log_message_body:p.snippet});}else if(p.__typename==="ThreadNameMessage"){Object.assign(y,{log_message_type:c('MercuryLogMessageType').THREAD_NAME,log_message_data:{name:p.thread_name},log_message_body:p.snippet});}else if(p.__typename==="ThreadImageMessage"){var ja=p.image_with_metadata,ka;if(c('bs_js_primitive').is_nil_undef(ja)){ka=null;}else{var la=ja.preview;ka={preview_url:c('bs_js_primitive').is_nil_undef(la)?null:la.uri,metadata:{fbid:ja.legacy_attachment_id,dimensions:c('bs_pervasives').string_of_int(ja.original_dimensions.x)+(","+c('bs_pervasives').string_of_int(ja.original_dimensions.y))}};}Object.assign(y,{log_message_type:c('MercuryLogMessageType').THREAD_IMAGE,log_message_data:{image:ka},log_message_body:p.snippet});}else if(p.__typename==="ParticipantsAddedMessage"){var ma=p.participants_added;Object.assign(y,{log_message_type:c('MercuryLogMessageType').SUBSCRIBE,log_message_data:{added_participants:c('bs_js_primitive').is_nil_undef(ma)?[]:c('bs_array').map(function(qa){return c('MercuryIDs').getParticipantIDFromUserID(qa.id);},ma)},log_message_body:p.snippet});}else if(p.__typename==="ParticipantLeftMessage"){var na=p.participants_removed;Object.assign(y,{log_message_type:c('MercuryLogMessageType').UNSUBSCRIBE,log_message_data:{removed_participants:c('bs_js_primitive').is_nil_undef(na)?[]:c('bs_array').map(function(qa){return c('MercuryIDs').getParticipantIDFromUserID(qa.id);},na)},log_message_body:p.snippet});}else if(p.__typename==="GenericAdminTextMessage"){var oa=p.extensible_message_admin_text,pa=p.extensible_message_admin_text_type;if(c('bs_js_primitive').is_nil_undef(oa)){if(!c('bs_js_primitive').is_nil_undef(pa))Object.assign(y,{log_message_body:p.snippet,log_message_data:{message_type:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('MessagingGenericAdminTextType')[pa])),untypedData:undefined},log_message_type:c('MercuryLogMessageType').GENERIC_ADMIN_TEXT});}else if(!c('bs_js_primitive').is_nil_undef(pa))Object.assign(y,h(oa,pa,p.snippet));}return y;}g._getGenericAdminTextMessage=h;g._getStyleList=i;g.unsafeCastExtensibleAttachmentWithoutSubattachments=j;g.unsafeCastExtensibleAttachment=k;g.unsafeCastBlobAttachments=l;g._getProfileRanges=m;g.transformMessage=n;}),null);
__d('messengerReadReceiptTransformerRe',['bs_array','bs_caml_format','bs_js_primitive'],(function a(b,c,d,e,f,g){'use strict';function h(i,j){var k={};c('bs_array').iter(function(l){var m=l.actor;if(!c('bs_js_primitive').is_nil_undef(m)&&i!==m.id){k[m.id]={action:c('bs_caml_format').caml_float_of_string(l.action),watermark:c('bs_caml_format').caml_float_of_string(l.watermark)};return 0;}else return 0;},j.nodes);return k;}g.transformReadReceipt=h;}),null);
__d('messengerThreadTransformerRe',['URI','bs_array','bs_string','bs_caml_array','bs_js_boolean','MercuryIDs','bs_caml_format','bs_js_primitive','bs_js_null_undefined','MessagingThreadType','messengerAttachmentTransformerRe','MessengerThreadCannotReplyReason'],(function a(b,c,d,e,f,g){'use strict';function h(p){var q=p.location_coordinates,r=c('bs_js_primitive').is_nil_undef(q)?[null,null]:[q.latitude,q.longitude],s=p.location_page,t;if(c('bs_js_primitive').is_nil_undef(s)){t=null;}else{var u=s.address;t=c('bs_js_primitive').is_nil_undef(u)?null:u.full_address;}var v=p.allows_rsvp,w=v!==0?1:0,x=c('bs_array').fold_left(function(z,aa){z[aa.node.id]=aa.guest_list_state;return z;},{},p.event_reminder_members.edges),y=p.lightweight_event_creator;return {creator_id:c('bs_js_primitive').is_nil_undef(y)?null:y.id,event_members:x,event_time:p.time,event_type:p.lightweight_event_type,latitude:r[0],longitude:r[1],location_address:t,location_name:p.location_name,note:p.note,oid:p.id,related_event:p.related_event,repeat_mode:p.repeat_mode,seconds_to_notify_before:p.seconds_to_notify_before,status:p.lightweight_event_status,title:p.event_title,track_rsvp:w};}function i(p){var q=p.associated_object;if(c('bs_js_primitive').is_nil_undef(q)){return null;}else{var r=q.action_link,s=q.profile_picture;return {id:q.id,name:q.name,action_link:c('bs_js_primitive').is_nil_undef(r)?null:new (c('URI'))(r).setDomain("www.facebook.com"),profile_picture:c('bs_js_primitive').is_nil_undef(s)?null:{uri:s.uri},room_type:q.room_type,privacy_mode:q.privacy_mode,approval_mode_toggleable:q.approval_mode_toggleable};}}function j(p){var q=p.related_page_thread;if(c('bs_js_primitive').is_nil_undef(q)){return null;}else{var r=q.page,s=c('bs_js_primitive').is_nil_undef(r)?[]:c('bs_array').map(function(t){return t.name;},r.custom_tags.nodes);return {flagged:q.is_flagged,customTagNames:s};}}function k(p){var q=p.thread_key.other_user_id;if(c('bs_js_primitive').is_nil_undef(q)){return 0;}else{var r=p.all_participants.nodes;return c('bs_array').fold_left(function(s,t){var u=t.messaging_actor;if(u.id===q){return +(u.__typename==="User");}else return s;},0,r);}}function l(p){if(p.length){var q={};c('bs_array').iter(function(r){var s=r.nickname;if(c('bs_js_primitive').is_nil_undef(s)){return 0;}else{q[r.participant_id]=s;return 0;}},p);return q;}else return null;}function m(p){if(!c('bs_js_primitive').is_nil_undef(p)&&p!==""){return "#"+c('bs_string').sub(p,2,p.length-2|0);}else return null;}function n(p){return c('bs_caml_array').caml_array_get(p,0);}function o(p,q,r){var s=q.customization_info,t;if(c('bs_js_primitive').is_nil_undef(s)){t=[null,null,null];}else{var u=s.emoji;t=[m(s.outgoing_bubble_color),c('bs_js_primitive').is_nil_undef(u)?null:{emoji:u},l(s.participant_customizations)];}var v=q.last_message.nodes.length?[c('bs_caml_array').caml_array_get(q.last_message.nodes,0)]:0,w=q.last_read_receipt.nodes.length?[c('bs_caml_array').caml_array_get(q.last_read_receipt.nodes,0)]:0,x;if(v){var y=v[0];x=c('messengerAttachmentTransformerRe').transformAttachment(p,{extensible_attachment:y.extensible_attachment,blob_attachments:y.blob_attachments,sticker:y.sticker},r);}else x=[];var z=q.cannot_reply_reason,aa=q.thread_queue_metadata,ba=q.thread_type,ca=q.montage_thread,da=q.image,ea=q.thread_key.other_user_id,fa=q.thread_queue_metadata,ga=q.name,ha=q.thread_key.other_user_id,ia;if(c('bs_js_primitive').is_nil_undef(ha)){var ja=q.thread_key.thread_fbid;ia=c('bs_js_primitive').is_nil_undef(ja)?q.thread_key.legacy_thread_id:ja;}else ia=ha;var ka=q.thread_key.legacy_thread_id,la=q.rtc_call_data,ma;if(c('bs_js_primitive').is_nil_undef(la)){ma=null;}else{var na=la.initiator;ma={call_state:la.call_state,server_info_data:la.server_info_data,initiator_fbid:c('bs_js_primitive').is_nil_undef(na)?0:c('bs_caml_format').caml_float_of_string(na.id)};}return {admin_ids:c('bs_array').map(function(oa){return oa.id;},q.thread_admins),approval_mode:q.approval_mode,approval_queue_ids:c('bs_js_primitive').is_nil_undef(aa)?[]:c('bs_array').map(function(oa){return c('MercuryIDs').getParticipantIDFromUserID(oa.id);},aa.approval_requests.nodes),can_reply:c('bs_js_primitive').is_nil_undef(z)?true:false,cannot_reply_reason:q.cannot_reply_reason,custom_color:t[0],custom_like_icon:t[1],custom_nickname:t[2],customization_enabled:q.customization_enabled,thread_type:c('bs_js_primitive').is_nil_undef(ba)?null:c('bs_js_null_undefined').from_opt(c('bs_js_primitive').undefined_to_opt(c('MessagingThreadType')[ba])),participant_add_mode:q.participant_add_mode_as_string,ephemeral_ttl_mode:q.ephemeral_ttl_mode,folder:c('bs_string').lowercase(q.folder),has_email_participant:c('bs_js_primitive').is_nil_undef(z)?false:c('bs_js_boolean').to_js_boolean(+(z===c('MessengerThreadCannotReplyReason').HAS_EMAIL_PARTICIPANT)),has_montage:c('bs_js_primitive').is_nil_undef(ca)?false:true,image_src:c('bs_js_primitive').is_nil_undef(da)?null:da.uri,is_archived:c('bs_js_boolean').to_js_boolean(q.has_viewer_archived),is_canonical_user:c('bs_js_boolean').to_js_boolean(k(q)),is_canonical:c('bs_js_primitive').is_nil_undef(ea)?false:true,is_pin_protected:c('bs_js_boolean').to_js_boolean(q.is_pin_protected),is_subscribed:c('bs_js_boolean').to_js_boolean(q.is_viewer_subscribed),is_thread_queue_enabled:c('bs_js_primitive').is_nil_undef(fa)?false:true,joinable_mode:{mode:q.joinable_mode.mode,link:q.joinable_mode.link},last_message_timestamp:v?c('bs_caml_format').caml_float_of_string(v[0].timestamp_precise):0,last_message_type:v?v[0].commerce_message_type:null,last_read_timestamp:w?c('bs_caml_format').caml_float_of_string(w[0].timestamp_precise):0,lightweight_event:q.event_reminders.nodes.length?h(c('bs_caml_array').caml_array_get(q.event_reminders.nodes,0)):null,message_count:q.message_count,mute_until:q.mute_until,name:c('bs_js_primitive').is_nil_undef(ga)?"":ga,other_user_fbid:q.thread_key.other_user_id,page_thread_info:j(q),participants:c('bs_array').map(function(oa){return c('MercuryIDs').getParticipantIDFromUserID(oa.messaging_actor.id);},q.all_participants.nodes),read_only:c('bs_js_primitive').is_nil_undef(z)?false:c('bs_js_boolean').to_js_boolean(+(z===c('MessengerThreadCannotReplyReason').READ_ONLY)),recipients_loadable:c('bs_js_primitive').is_nil_undef(z)?true:c('bs_js_boolean').to_js_boolean(+(z!==c('MessengerThreadCannotReplyReason').RECIPIENTS_NOT_LOADABLE)),server_timestamp:c('bs_caml_format').caml_float_of_string(q.updated_time_precise),snippet_attachments:x,snippet_sender:v?c('MercuryIDs').getParticipantIDFromUserID(v[0].message_sender.messaging_actor.id):null,snippet:v?v[0].snippet:null,thread_fbid:ia,thread_id:c('bs_js_primitive').is_nil_undef(ka)?"":ka,timestamp:c('bs_caml_format').caml_float_of_string(q.updated_time_precise),top_emojis:q.top_emojis,unread_count:q.unread_count,rtc_call_data:ma,associated_object:i(q),reactions_mute_mode:q.reactions_mute_mode==="REACTIONS_NOT_MUTED"?0:1,mentions_mute_mode:q.mentions_mute_mode==="MENTIONS_NOT_MUTED"?0:1};}g._getLightweightEvent=h;g._getAssociatedObject=i;g._getPageThreadInfo=j;g._getIsCanonicalUser=k;g._getNicknames=l;g._getCustomColor=m;g.indexZero=n;g.transformThread=o;}),null);
__d('messengerGraphQLThreadFetcherRe',['Promise','bs_array','getByPath','bs_caml_array','bs_pervasives','WebGraphQL','bs_js_primitive','messengerThreadTransformerRe','messengerMessageTransformerRe','MessengerThreadsWebGraphQLQuery','messengerReadReceiptTransformerRe'],(function a(b,c,d,e,f,g){'use strict';function h(l,m,n){var o=c('bs_array').map(function(p){var q=c('messengerMessageTransformerRe').unsafeCastBlobAttachments(p),r=p.extensible_attachment,s;if(c('bs_js_primitive').is_nil_undef(r)){s=null;}else{var t=r.story_attachment;s={legacy_attachment_id:r.legacy_attachment_id,story_attachment:c('bs_js_primitive').is_nil_undef(t)?null:c('messengerMessageTransformerRe').unsafeCastExtensibleAttachment(t)};}return {snippet:p.snippet,message_sender:p.message_sender,timestamp_precise:p.timestamp_precise,commerce_message_type:p.commerce_message_type,extensible_attachment:s,blob_attachments:q,sticker:p.sticker};},m.last_message.nodes);return c('messengerThreadTransformerRe').transformThread(l,{thread_key:m.thread_key,name:m.name,all_participants:m.all_participants,last_message:{nodes:o},unread_count:m.unread_count,message_count:m.messages_count,image:m.image,updated_time_precise:m.updated_time_precise,mute_until:m.mute_until,is_pin_protected:m.is_pin_protected,is_viewer_subscribed:m.is_viewer_subscribed,thread_queue_enabled:m.thread_queue_enabled,folder:m.folder,has_viewer_archived:m.has_viewer_archived,cannot_reply_reason:m.cannot_reply_reason,ephemeral_ttl_mode:m.ephemeral_ttl_mode,customization_info:m.customization_info,thread_admins:m.thread_admins,approval_mode:m.approval_mode,joinable_mode:m.joinable_mode,thread_queue_metadata:m.thread_queue_metadata,event_reminders:m.event_reminders,montage_thread:m.montage_thread,last_read_receipt:m.last_read_receipt,related_page_thread:m.related_page_thread,rtc_call_data:m.rtc_call_data,associated_object:m.associated_object,reactions_mute_mode:m.reactions_mute_mode,mentions_mute_mode:m.mentions_mute_mode,privacy_mode:m.privacy_mode,customization_enabled:m.customization_enabled,thread_type:m.thread_type,participant_add_mode_as_string:m.participant_add_mode_as_string,top_emojis:m.top_emojis},n);}function i(l,m,n,o,p){if(c('bs_js_primitive').is_nil_undef(l)){if(o!==0){return {actions:null,thread:undefined,end_of_history:{type:"user",fbid:m},roger:null};}else return {actions:null,thread:undefined,end_of_history:undefined,roger:null};}else{var q=l.thread_key.other_user_id,r=l.thread_key.thread_fbid,s=l.thread_key.legacy_thread_id,t=c('bs_js_primitive').is_nil_undef(q)?c('bs_js_primitive').is_nil_undef(r)?c('bs_js_primitive').is_nil_undef(s)?c('bs_pervasives').failwith("No thread ID"):s:r:q;if(t!==m)c('bs_pervasives').failwith("Thread ID mismatch");var u=h(n,l,p),v=l.messages,w=c('bs_js_primitive').is_nil_undef(v)?null:c('bs_array').map(function(ba){return c('messengerMessageTransformerRe').transformMessage(n,ba,{thread_id:l.thread_key.legacy_thread_id,thread_fbid:l.thread_key.thread_fbid,other_user_fbid:l.thread_key.other_user_id,folder:u.folder},p);},v.nodes),x=l.read_receipts,y;if(c('bs_js_primitive').is_nil_undef(x)){y=null;}else{var z={};z[m]=c('messengerReadReceiptTransformerRe').transformReadReceipt(n,x);y=z;}var aa=c('getByPath')(l,["messages","page_info"]);if(c('bs_js_primitive').is_nil_undef(aa)){return {actions:w,thread:u,end_of_history:undefined,roger:y};}else if(aa.has_previous_page){return {actions:w,thread:u,end_of_history:undefined,roger:y};}else return {actions:w,thread:u,end_of_history:{type:"thread",fbid:m},roger:y};}}function j(l){return new (c('MessengerThreadsWebGraphQLQuery'))({id:l.id,message_limit:l.limit,load_messages:+(l.limit>0),load_read_receipts:l.loadReadReceipts,before:l.timestamp});}function k(l,m,n){var o=c('bs_array').map(j,m);return c('Promise').all(c('WebGraphQL').execAll(o,{actorID:n?l:null})).then(function(p){return c('bs_array').mapi(function(q,r){var s=r.message_thread,t=c('bs_caml_array').caml_array_get(m,q);return i(s,t.id,l,t.isCanonical,n);},p);});}g.transformThread=h;g._transformPayload=i;g._getQuery=j;g.fetchAll=k;}),null);